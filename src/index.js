function createBoard(r){var t=document.querySelector("table");for(let e=1;e<=r;e++){var a=document.createElement("tr");t.append(a);for(let t=1;t<=r;t++){var d=document.createElement("td");d.setAttribute("id",e.toString()+t.toString()),d.classList.add((e+t)%2?"blackBoard":"whiteBoard"),a.append(d)}}}
const anyLocArr=[{vert:1,hori:1}];class ML{static movableLocation(r,e,t){switch(r){case Pieces.King:return ML.king(e,t);case Pieces.Queen:return ML.queen(e,t);case Pieces.Bishop:return ML.bishop(e,t);case Pieces.Night:return ML.night(e,t);case Pieces.Rook:return ML.rook(e,t);case Pieces.Pawn:return e===Sides.White?ML.whitePawn(e,t):ML.blackPawn(e,t)}}static king(r,e){return anyLocArr}static queen(r,e){return anyLocArr}static bishop(r,e){return anyLocArr}static night(r,e){return anyLocArr}static rook(r,e){return anyLocArr}static whitePawn(r,e){return anyLocArr}static blackPawn(r,e){return anyLocArr}}
function p(e,c,s,i){let a,r;switch(e){case"w":a=Sides.White;break;case"b":a=Sides.Black}switch(c){case"k":r=Pieces.King;break;case"q":r=Pieces.Queen;break;case"b":r=Pieces.Bishop;break;case"n":r=Pieces.Night;break;case"r":r=Pieces.Rook;break;case"p":r=Pieces.Pawn}return new Piece(a,r,{vert:s,hori:i})}
class Board{constructor(e){this.board=[p("w","k",8,5),p("w","q",8,4),p("w","b",8,3),p("w","b",8,6),p("w","n",8,2),p("w","n",8,7),p("w","r",8,1),p("w","r",8,8),p("b","k",1,5),p("b","q",1,4),p("b","b",1,3),p("b","b",1,6),p("b","n",1,2),p("b","n",1,7),p("b","r",1,1),p("b","r",1,8)],this.clicked=!1,this.clickedThingIdx=0;for(let e=1;e<=8;e++)this.board.push(p("w","p",7,e)),this.board.push(p("b","p",2,e));this.boardSize=e}getPieceIndexByLocation(e){let t=0;for(var i of this.board){if(i.vert===e.vert&&i.hori===e.hori)return t;t++}return-1}activateListenersOf(i){for(let t=1;t<=this.boardSize;t++)for(let e=1;e<=this.boardSize;e++){var o=this.getPieceIndexByLocation({vert:t,hori:e});if(-1===o){const c=byString({vert:t,hori:e});null!=(r=document.getElementById(c))&&r.addEventListener("click",()=>{console.log("NULL Piece pressed",c)})}else{var r=this.board[o];r.side===i&&r.activateListener(this.board,e=>{this.clicked=!0,this.clickedThingIdx=this.getPieceIndexByLocation(e)})}}}async clickedPiece(){this.clicked=!1,setInterval(()=>{if(console.log("hello"),this.clicked)return this.clicked=!1,console.log("what"),this.clickedThingIdx},200)}}class Piece{constructor(e,t,i){this.side=e,this.piece=t,this.location=i}get vert(){return this.location.vert}get hori(){return this.location.hori}activateListener(t,i){var e;null!=(e=document.getElementById(byString(this.location)))&&e.addEventListener("click",()=>{var e=ML.movableLocation(this.piece,this.side,t);console.log(byString(this.location)+"'s movable locations :",e),i(this.location)})}}
function showBoard(e,i,t=[]){var o,c,n=[Pieces.King,Pieces.Queen,Pieces.Bishop,Pieces.Night,Pieces.Rook,Pieces.Pawn],s=["왕","여왕","비숍","말","룩","폰"];for(o of e.board){var a=document.getElementById(byString(o.location));a.classList.remove("whitePiece","blackPiece"),a.classList.add(o.side===Sides.White?"whitePiece":"blackPiece"),a.textContent=s[n.indexOf(o.piece)]}for(let e=11;e<=10*i+1;e+=10){var r=document.getElementById(e.toString());r.innerHTML||(r.innerHTML="&nbsp;")}for(c of t){var d=document.getElementById(byString(c));d.classList.remove("whiteBoard","blackBoard"),d.classList.add("movableLocation")}}
var Pieces,Sides;function byString(i){return Object.values(i).join("")}!function(i){i[i.King=0]="King",i[i.Queen=1]="Queen",i[i.Bishop=2]="Bishop",i[i.Night=3]="Night",i[i.Rook=4]="Rook",i[i.Pawn=5]="Pawn"}(Pieces=Pieces||{}),function(i){i[i.White=0]="White",i[i.Black=1]="Black"}(Sides=Sides||{});
class Game{constructor({boardSize:i=8}){this.turn=Sides.White,this.situation=[],this.boardSize=8<=i?i:8,createBoard(this.boardSize),this.b=new Board(this.boardSize),showBoard(this.b,this.boardSize),this.b.activateListenersOf(this.turn)}changeTurn(){this.turn=this.turn===Sides.White?Sides.Black:Sides.White,showBoard(this.b,this.boardSize)}addSituation(i){this.situation.push(i)}}async function main(){for(var i=new Game({boardSize:8});;){console.log(i.turn);var t=await i.b.clickedPiece();console.log(t);break}}main();